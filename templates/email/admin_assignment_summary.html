<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ title|default:"Assignment Summary" }}</title>
  <style>
    body { font-family: Arial, sans-serif; color: #222; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 12px 16px; }
    h1 { font-size: 18px; margin: 0 0 12px; }
    table { width: 100%; border-collapse: collapse; margin-top: 8px; }
    th, td { border: 1px solid #e5e5e5; padding: 8px; font-size: 14px; vertical-align: top; }
    th { background: #f7f7f7; text-align: left; width: 30%; }
    .small { color: #666; font-size: 12px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>{{ title|default:"Assignment Summary" }}</h1>

    {# Case A: single "items" list with label/value pairs #}
    {% if items %}
      <table role="presentation">
        <tbody>
          {% for row in items %}
            <tr>
              <th>{{ row.label }}</th>
              <td>
                {% if row.value|date:"" %}
                  {{ row.value|date:"Y-m-d H:i" }}
                {% else %}
                  {{ row.value }}
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}

    {# Case B: tabular "items_table" list of dicts (e.g., bulk) #}
    {% if items_table %}
      <table role="presentation" style="margin-top:16px;">
        <thead>
          <tr>
            {% for h in items_table.0.keys %}
              <th>{{ h }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for r in items_table %}
            <tr>
              {% for h in r.keys %}
                <td>
                  {% with v=r|dictsort:0 %}{% endwith %}{# noop to load filters #}
                  {% if r.h|date:"" %}
                    {{ r.h|date:"Y-m-d H:i" }}
                  {% else %}
                    {{ r.h }}
                  {% endif %}
                </td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}

    <p class="small">This is an automated message.</p>
  </div>
</body>
</html>
